---
layout: post
title: 프로젝트에서 Redis를 선택한 이유.
image: 
  path: /assets/img/blog/jeremy-bishop@0,5x.jpg
description: >
  프로젝트를 시작하기 전 리프레시 토큰을 저장하는 곳을 레디스로 결정한 이유.
sitemap: false
---

## 프로젝트에서 Redis를 선택한 이유에 대해서 적어보았습니다!

## 주어진 상황
기존 프로젝트를 진행할 때 리프레시 토큰을 RDBMS인 MySQL에 한 컬럼으로 저장하였다.  
처음 로그인할때나 토큰을 재발급 할 때 마다 데이터베이스에 업데이트 쿼리가 발생하는 점과 속도 측으로 자주 업데이트 되는 값이기에 인덱싱을 걸기도 애매한 상황이 발생하였습니다.

찾아보던중 공부했던 NOSQL이 생각나게 되어 키-밸류로 저장되는 데이터베이스인 Redis와 Memcached를 찾아보게 되었습니다.  

## 두 NOSQL의 차이점
두 데이터베이스의 차이점은 

![image](/assets/img/blog/RedisMemcached.png)

Memcached는 명료하고 단순하게 개발된 반면 레디스는 다양한 용도에 효과적으로 사용될 수 있도록 많은 특징을 가지고 개발된 차이점이 존재하였죠.

### 어떤걸 선택해야하지?

진행하던 프로젝트에 더욱 맞는게 무엇일까라고 고민을 하다 정리 해보기로 하였습니다.

1. 속도가 빠른가?
2. TTL 만료일이 지나면 삭제가 되게 할 수 있나?
3. 서버가 죽었을떄 정보가 남아있나?

이 정도로 기준을 정해봤었는데요.  
1,2번은 두 데이터베이스 모두 적용 되지만 3번에서 결과가 갈렸습니다.  

저희 메인 브랜치에 Merge가 될 시 CD가 동작하여 레디스, 서버를 재배포하게 할 생각이였기에.

이 과정 속에서 리프레시토큰이 날라가게된다면 기존 사용자들은 재 로그인을 해야하는 불편한 점을 생각하여 복구가 가능한 레디스에 한 표를 던지게 되었습니다.

추가로 프로젝트에서 캐싱을 할 계획까지 있기에 확장성이 높은 레디스를 선택하게 되었습니다.